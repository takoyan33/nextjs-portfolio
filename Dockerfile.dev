# Use official Node.js image as base
FROM node:20-alpine

# Create app directory
WORKDIR /usr/src/app

# Copy only package files first
COPY package.json yarn.lock ./

# Use local cache dir for yarn
RUN yarn config set cache-folder /usr/src/app/.yarn-cache

# Install dependencies
RUN yarn install

# Copy source code, but exclude node_modules
COPY . .

EXPOSE 3001
CMD ["yarn", "dev"]